(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
var CastPlayer, beginCast, init, renderEntries, showHistory, showList, showPlaylist, showQueue, socket;

socket = null;

renderEntries = function(entries, isMap) {
  var e, extraInfo, html, i, k, len, m, params, title, url, v;
  html = "";
  if (isMap) {
    console.log(entries);
    m = entries;
    entries = [];
    for (k in m) {
      v = m[k];
      entries.push(v);
    }
    // This is the "all" list, sort it
    entries.sort(function(a, b) {
      if (a.title < b.title) {
        return -1;
      }
      if (a.title > b.title) {
        return 1;
      }
      return 0;
    });
  }
  for (i = 0, len = entries.length; i < len; i++) {
    e = entries[i];
    title = e.title;
    if (title == null) {
      title = e.id;
    }
    params = "";
    if (e.start >= 0) {
      params += params.length === 0 ? "?" : "&";
      params += `start=${e.start}`;
    }
    if (e.end >= 0) {
      params += params.length === 0 ? "?" : "&";
      params += `end=${e.end}`;
    }
    url = `https://youtu.be/${e.id}${params}`;
    extraInfo = "";
    if (e.countPlay != null) {
      extraInfo += `, ${e.countPlay} play${e.countPlay === 1 ? "" : "s"}`;
    }
    if (e.countSkip != null) {
      extraInfo += `, ${e.countSkip} skip${e.countSkip === 1 ? "" : "s"}`;
    }
    html += `<div> * <a target="_blank" href="${url}">${title}</a> <span class="user">(${e.user}${extraInfo})</span></div>
`;
  }
  return document.getElementById("main").innerHTML = html;
};

showList = function(url, isMap = false) {
  var xhttp;
  document.getElementById('main').innerHTML = "";
  xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    var entries;
    if ((this.readyState === 4) && (this.status === 200)) {
      try {
        // Typical action to be performed when the document is ready:
        entries = JSON.parse(xhttp.responseText);
        return renderEntries(entries, isMap);
      } catch (error) {
        return document.getElementById("main").innerHTML = "Error!";
      }
    }
  };
  xhttp.open("GET", url, true);
  return xhttp.send();
};

showHistory = function() {
  return showList("/info/history");
};

showQueue = function() {
  return showList("/info/queue");
};

showPlaylist = function() {
  return showList("/info/playlist", true);
};

CastPlayer = class CastPlayer {
  constructor() {
    this.remotePlayer = null;
    this.remotePlayerController = null;
  }

  initializeCastPlayer() {
    var options;
    options = {
      autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,
      receiverApplicationId: chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID
    };
    cast.framework.CastContext.getInstance().setOptions(options);
    this.remotePlayer = new cast.framework.RemotePlayer();
    this.remotePlayerController = new cast.framework.RemotePlayerController(this.remotePlayer);
    return this.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED, this.switchPlayer.bind(this));
  }

  switchPlayer() {
    var sessionState;
    sessionState = cast.framework.CastContext.getInstance().getSessionState();
    if (sessionState !== cast.framework.SessionState.SESSION_STARTED) {
      console.log("Session ended!");
      return;
    }
    console.log("Session starting!");
    return socket.emit('castready', {
      id: socket.id
    });
  }

};

beginCast = function(pkt) {
  var castSession, mediaInfo, request, sessionState;
  console.log("CAST:", pkt);
  sessionState = cast.framework.CastContext.getInstance().getSessionState();
  if (sessionState !== cast.framework.SessionState.SESSION_STARTED) {
    console.log("No session; skipping beginCast");
    return;
  }
  console.log("Starting cast!");
  castSession = cast.framework.CastContext.getInstance().getCurrentSession();
  mediaInfo = new chrome.cast.media.MediaInfo(pkt.url, 'video/mp4');
  request = new chrome.cast.media.LoadRequest(mediaInfo);
  if (pkt.start > 0) {
    request.currentTime = pkt.start;
  }
  return castSession.loadMedia(request);
};

init = function() {
  window.showHistory = showHistory;
  window.showQueue = showQueue;
  window.showPlaylist = showPlaylist;
  showHistory();
  socket = io();
  socket.on('cast', function(pkt) {
    return beginCast(pkt);
  });
  window.__onGCastApiAvailable = function(isAvailable) {
    var castPlayer;
    console.log(`__onGCastApiAvailable fired: ${isAvailable}`);
    castPlayer = new CastPlayer();
    if (isAvailable) {
      return castPlayer.initializeCastPlayer();
    }
  };
  return console.log("initialized!");
};

window.onload = init;


},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvY2xpZW50L2Rhc2hib2FyZC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxJQUFBLFVBQUEsRUFBQSxTQUFBLEVBQUEsSUFBQSxFQUFBLGFBQUEsRUFBQSxXQUFBLEVBQUEsUUFBQSxFQUFBLFlBQUEsRUFBQSxTQUFBLEVBQUE7O0FBQUEsTUFBQSxHQUFTOztBQUVULGFBQUEsR0FBZ0IsUUFBQSxDQUFDLE9BQUQsRUFBVSxLQUFWLENBQUE7QUFDaEIsTUFBQSxDQUFBLEVBQUEsU0FBQSxFQUFBLElBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQSxDQUFBLEVBQUEsTUFBQSxFQUFBLEtBQUEsRUFBQSxHQUFBLEVBQUE7RUFBRSxJQUFBLEdBQU87RUFFUCxJQUFHLEtBQUg7SUFDRSxPQUFPLENBQUMsR0FBUixDQUFZLE9BQVo7SUFDQSxDQUFBLEdBQUk7SUFDSixPQUFBLEdBQVU7SUFDVixLQUFBLE1BQUE7O01BQ0UsT0FBTyxDQUFDLElBQVIsQ0FBYSxDQUFiO0lBREYsQ0FISjs7SUFPSSxPQUFPLENBQUMsSUFBUixDQUFhLFFBQUEsQ0FBQyxDQUFELEVBQUksQ0FBSixDQUFBO01BQ1gsSUFBRyxDQUFDLENBQUMsS0FBRixHQUFVLENBQUMsQ0FBQyxLQUFmO0FBQ0UsZUFBTyxDQUFDLEVBRFY7O01BRUEsSUFBRyxDQUFDLENBQUMsS0FBRixHQUFVLENBQUMsQ0FBQyxLQUFmO0FBQ0UsZUFBTyxFQURUOztBQUVBLGFBQU87SUFMSSxDQUFiLEVBUkY7O0VBZUEsS0FBQSx5Q0FBQTs7SUFDRSxLQUFBLEdBQVEsQ0FBQyxDQUFDO0lBQ1YsSUFBTyxhQUFQO01BQ0UsS0FBQSxHQUFRLENBQUMsQ0FBQyxHQURaOztJQUVBLE1BQUEsR0FBUztJQUNULElBQUcsQ0FBQyxDQUFDLEtBQUYsSUFBVyxDQUFkO01BQ0UsTUFBQSxJQUFhLE1BQU0s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YixJQUFHLFdBQUg7YUFDRSxVQUFVLENBQUMsb0JBQVgsQ0FBQSxFQURGOztFQUg2QjtTQU0vQixPQUFPLENBQUMsR0FBUixDQUFZLGNBQVo7QUFqQks7O0FBbUJQLE1BQU0sQ0FBQyxNQUFQLEdBQWdCIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwic29ja2V0ID0gbnVsbFxyXG5cclxucmVuZGVyRW50cmllcyA9IChlbnRyaWVzLCBpc01hcCkgLT5cclxuICBodG1sID0gXCJcIlxyXG5cclxuICBpZiBpc01hcFxyXG4gICAgY29uc29sZS5sb2cgZW50cmllc1xyXG4gICAgbSA9IGVudHJpZXNcclxuICAgIGVudHJpZXMgPSBbXVxyXG4gICAgZm9yIGssIHYgb2YgbVxyXG4gICAgICBlbnRyaWVzLnB1c2ggdlxyXG5cclxuICAgICMgVGhpcyBpcyB0aGUgXCJhbGxcIiBsaXN0LCBzb3J0IGl0XHJcbiAgICBlbnRyaWVzLnNvcnQgKGEsIGIpIC0+XHJcbiAgICAgIGlmIGEudGl0bGUgPCBiLnRpdGxlXHJcbiAgICAgICAgcmV0dXJuIC0xXHJcbiAgICAgIGlmIGEudGl0bGUgPiBiLnRpdGxlXHJcbiAgICAgICAgcmV0dXJuIDFcclxuICAgICAgcmV0dXJuIDBcclxuXHJcbiAgZm9yIGUgaW4gZW50cmllc1xyXG4gICAgdGl0bGUgPSBlLnRpdGxlXHJcbiAgICBpZiBub3QgdGl0bGU/XHJcbiAgICAgIHRpdGxlID0gZS5pZFxyXG4gICAgcGFyYW1zID0gXCJcIlxyXG4gICAgaWYgZS5zdGFydCA+PSAwXHJcbiAgICAgIHBhcmFtcyArPSBpZiBwYXJhbXMubGVuZ3RoID09IDAgdGhlbiBcIj9cIiBlbHNlIFwiJlwiXHJcbiAgICAgIHBhcmFtcyArPSBcInN0YXJ0PSN7ZS5zdGFydH1cIlxyXG4gICAgaWYgZS5lbmQgPj0gMFxyXG4gICAgICBwYXJhbXMgKz0gaWYgcGFyYW1zLmxlbmd0aCA9PSAwIHRoZW4gXCI/XCIgZWxzZSBcIiZcIlxyXG4gICAgICBwYXJhbXMgKz0gXCJlbmQ9I3tlLmVuZH1cIlxyXG4gICAgdXJsID0gXCJodHRwczovL3lvdXR1LmJlLyN7ZS5pZH0je3BhcmFtc31cIlxyXG4gICAgZXh0cmFJbmZvID0gXCJcIlxyXG4gICAgaWYgZS5jb3VudFBsYXk/XHJcbiAgICAgIGV4dHJhSW5mbyArPSBcIiwgI3tlLmNvdW50UGxheX0gcGxheSN7aWYgZS5jb3VudFBsYXkgPT0gMSB0aGVuIFwiXCIgZWxzZSBcInNcIn1cIlxyXG4gICAgaWYgZS5jb3VudFNraXA/XHJcbiAgICAgIGV4dHJhSW5mbyArPSBcIiwgI3tlLmNvdW50U2tpcH0gc2tpcCN7aWYgZS5jb3VudFNraXAgPT0gMSB0aGVuIFwiXCIgZWxzZSBcInNcIn1cIlxyXG4gICAgaHRtbCArPSBcIlwiXCJcclxuICAgICAgPGRpdj4gKiA8YSB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPVwiI3t1cmx9XCI+I3t0aXRsZX08L2E+IDxzcGFuIGNsYXNzPVwidXNlclwiPigje2UudXNlcn0je2V4dHJhSW5mb30pPC9zcGFuPjwvZGl2PlxyXG5cclxuICAgIFwiXCJcIlxyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFpblwiKS5pbm5lckhUTUwgPSBodG1sXHJcblxyXG5cclxuc2hvd0xpc3QgPSAodXJsLCBpc01hcCA9IGZhbHNlKSAtPlxyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJykuaW5uZXJIVE1MID0gXCJcIlxyXG4gIHhodHRwID0gbmV3IFhNTEh0dHBSZXF1ZXN0KClcclxuICB4aHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAtPlxyXG4gICAgICBpZiAoQHJlYWR5U3RhdGUgPT0gNCkgYW5kIChAc3RhdHVzID09IDIwMClcclxuICAgICAgICAgIyBUeXBpY2FsIGFjdGlvbiB0byBiZSBwZXJmb3JtZWQgd2hlbiB0aGUgZG9jdW1lbnQgaXMgcmVhZHk6XHJcbiAgICAgICAgIHRyeVxyXG4gICAgICAgICAgIGVudHJpZXMgPSBKU09OLnBhcnNlKHhodHRwLnJlc3BvbnNlVGV4dClcclxuICAgICAgICAgICByZW5kZXJFbnRyaWVzKGVudHJpZXMsIGlzTWFwKVxyXG4gICAgICAgICBjYXRjaFxyXG4gICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFpblwiKS5pbm5lckhUTUwgPSBcIkVycm9yIVwiXHJcbiAgeGh0dHAub3BlbihcIkdFVFwiLCB1cmwsIHRydWUpXHJcbiAgeGh0dHAuc2VuZCgpXHJcblxyXG5zaG93SGlzdG9yeSA9IC0+IHNob3dMaXN0KFwiL2luZm8vaGlzdG9yeVwiKVxyXG5zaG93UXVldWUgPSAtPiBzaG93TGlzdChcIi9pbmZvL3F1ZXVlXCIpXHJcbnNob3dQbGF5bGlzdCA9IC0+IHNob3dMaXN0KFwiL2luZm8vcGxheWxpc3RcIiwgdHJ1ZSlcclxuXHJcbmNsYXNzIENhc3RQbGF5ZXJcclxuICBjb25zdHJ1Y3RvcjogLT5cclxuICAgIEByZW1vdGVQbGF5ZXIgPSBudWxsXHJcbiAgICBAcmVtb3RlUGxheWVyQ29udHJvbGxlciA9IG51bGxcclxuXHJcbiAgaW5pdGlhbGl6ZUNhc3RQbGF5ZXI6IC0+XHJcbiAgICBvcHRpb25zID1cclxuICAgICAgYXV0b0pvaW5Qb2xpY3k6IGNocm9tZS5jYXN0LkF1dG9Kb2luUG9saWN5Lk9SSUdJTl9TQ09QRURcclxuICAgICAgcmVjZWl2ZXJBcHBsaWNhdGlvbklkOiBjaHJvbWUuY2FzdC5tZWRpYS5ERUZBVUxUX01FRElBX1JFQ0VJVkVSX0FQUF9JRFxyXG4gICAgY2FzdC5mcmFtZXdvcmsuQ2FzdENvbnRleHQuZ2V0SW5zdGFuY2UoKS5zZXRPcHRpb25zKG9wdGlvbnMpXHJcbiAgICBAcmVtb3RlUGxheWVyID0gbmV3IGNhc3QuZnJhbWV3b3JrLlJlbW90ZVBsYXllcigpXHJcbiAgICBAcmVtb3RlUGxheWVyQ29udHJvbGxlciA9IG5ldyBjYXN0LmZyYW1ld29yay5SZW1vdGVQbGF5ZXJDb250cm9sbGVyKEByZW1vdGVQbGF5ZXIpXHJcbiAgICBAcmVtb3RlUGxheWVyQ29udHJvbGxlci5hZGRFdmVudExpc3RlbmVyKGNhc3QuZnJhbWV3b3JrLlJlbW90ZVBsYXllckV2ZW50VHlwZS5JU19DT05ORUNURURfQ0hBTkdFRCwgQHN3aXRjaFBsYXllci5iaW5kKHRoaXMpKVxyXG5cclxuICBzd2l0Y2hQbGF5ZXI6IC0+XHJcbiAgICBzZXNzaW9uU3RhdGUgPSBjYXN0LmZyYW1ld29yay5DYXN0Q29udGV4dC5nZXRJbnN0YW5jZSgpLmdldFNlc3Npb25TdGF0ZSgpXHJcbiAgICBpZiBzZXNzaW9uU3RhdGUgIT0gY2FzdC5mcmFtZXdvcmsuU2Vzc2lvblN0YXRlLlNFU1NJT05fU1RBUlRFRFxyXG4gICAgICBjb25zb2xlLmxvZyBcIlNlc3Npb24gZW5kZWQhXCJcclxuICAgICAgcmV0dXJuXHJcblxyXG4gICAgY29uc29sZS5sb2cgXCJTZXNzaW9uIHN0YXJ0aW5nIVwiXHJcbiAgICBzb2NrZXQuZW1pdCAnY2FzdHJlYWR5JywgeyBpZDogc29ja2V0LmlkIH1cclxuXHJcbmJlZ2luQ2FzdCA9IChwa3QpIC0+XHJcbiAgY29uc29sZS5sb2cgXCJDQVNUOlwiLCBwa3RcclxuXHJcbiAgc2Vzc2lvblN0YXRlID0gY2FzdC5mcmFtZXdvcmsuQ2FzdENvbnRleHQuZ2V0SW5zdGFuY2UoKS5nZXRTZXNzaW9uU3RhdGUoKVxyXG4gIGlmIHNlc3Npb25TdGF0ZSAhPSBjYXN0LmZyYW1ld29yay5TZXNzaW9uU3RhdGUuU0VTU0lPTl9TVEFSVEVEXHJcbiAgICBjb25zb2xlLmxvZyBcIk5vIHNlc3Npb247IHNraXBwaW5nIGJlZ2luQ2FzdFwiXHJcbiAgICByZXR1cm5cclxuXHJcbiAgY29uc29sZS5sb2cgXCJTdGFydGluZyBjYXN0IVwiXHJcbiAgY2FzdFNlc3Npb24gPSBjYXN0LmZyYW1ld29yay5DYXN0Q29udGV4dC5nZXRJbnN0YW5jZSgpLmdldEN1cnJlbnRTZXNzaW9uKClcclxuICBtZWRpYUluZm8gPSBuZXcgY2hyb21lLmNhc3QubWVkaWEuTWVkaWFJbmZvKHBrdC51cmwsICd2aWRlby9tcDQnKVxyXG4gIHJlcXVlc3QgPSBuZXcgY2hyb21lLmNhc3QubWVkaWEuTG9hZFJlcXVlc3QobWVkaWFJbmZvKVxyXG4gIGlmIHBrdC5zdGFydCA+IDBcclxuICAgIHJlcXVlc3QuY3VycmVudFRpbWUgPSBwa3Quc3RhcnRcclxuICBjYXN0U2Vzc2lvbi5sb2FkTWVkaWEocmVxdWVzdClcclxuXHJcbmluaXQgPSAtPlxyXG4gIHdpbmRvdy5zaG93SGlzdG9yeSA9IHNob3dIaXN0b3J5XHJcbiAgd2luZG93LnNob3dRdWV1ZSA9IHNob3dRdWV1ZVxyXG4gIHdpbmRvdy5zaG93UGxheWxpc3QgPSBzaG93UGxheWxpc3RcclxuXHJcbiAgc2hvd0hpc3RvcnkoKVxyXG5cclxuICBzb2NrZXQgPSBpbygpXHJcbiAgc29ja2V0Lm9uICdjYXN0JywgKHBrdCkgLT5cclxuICAgIGJlZ2luQ2FzdChwa3QpXHJcblxyXG4gIHdpbmRvdy5fX29uR0Nhc3RBcGlBdmFpbGFibGUgPSAoaXNBdmFpbGFibGUpIC0+XHJcbiAgICBjb25zb2xlLmxvZyBcIl9fb25HQ2FzdEFwaUF2YWlsYWJsZSBmaXJlZDogI3tpc0F2YWlsYWJsZX1cIlxyXG4gICAgY2FzdFBsYXllciA9IG5ldyBDYXN0UGxheWVyXHJcbiAgICBpZiBpc0F2YWlsYWJsZVxyXG4gICAgICBjYXN0UGxheWVyLmluaXRpYWxpemVDYXN0UGxheWVyKClcclxuXHJcbiAgY29uc29sZS5sb2cgXCJpbml0aWFsaXplZCFcIlxyXG5cclxud2luZG93Lm9ubG9hZCA9IGluaXRcclxuIl19
